import { Application, Router } from 'https://deno.land/x/oak/mod.ts';
import { encode, decode } from "https://deno.land/std/encoding/base64.ts"

const port = 8000;
const app = new Application();

const router = new Router();

router.get('/', (ctx) => {
  ctx.response.body = 'Received a GET HTTP method';
});

router.post('/api/saml', async(ctx) => {

  const { value } = ctx.request.body({ type: 'text' });
  ctx.response.body = wait value ;

//   const  post_txt = await value;
//   let b64_str    = post_txt.replace("SAMLResponse=","")
// //   b64_str        = `PHNhbWxwOlJlc3BvbnNlIFZlcnNpb249IjIuMCIgSUQ9IkV6M3htcHZZMkdEWmw1QVpTNkNYdmsteDNSRSIgSXNzdWVJbnN0YW50PSIyMDIzLTAxLTI3VDA0OjI2OjM0LjEzNFoiIERlc3RpbmF0aW9uPSJodHRwOi8vbG9jYWxob3N0OjgwMDAvYXBpL3NhbWwiIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiPjxzYW1sOklzc3VlciB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5odHRwczovL2lkcC5teWlkLmRpc25leS5jb208L3NhbWw6SXNzdWVyPjxkczpTaWduYXR1cmUgeG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxkczpTaWduZWRJbmZvPjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PGRzOlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiLz48ZHM6UmVmZXJlbmNlIFVSST0iI0V6M3htcHZZMkdEWmw1QVpTNkNYdmsteDNSRSI+PGRzOlRyYW5zZm9ybXM+PGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlIi8+PGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPjwvZHM6VHJhbnNmb3Jtcz48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+PGRzOkRpZ2VzdFZhbHVlPjEvKzQxUXJJbXgvN1FHUkNERjV2N1lWSG0wNzNyVjhtS24vcnFWUWtsSUk9PC9kczpEaWdlc3RWYWx1ZT48L2RzOlJlZmVyZW5jZT48L2RzOlNpZ25lZEluZm8+PGRzOlNpZ25hdHVyZVZhbHVlPkhCd1ExdnpqY1Y4aVliZFdDbE1WR1BCK2tNVnFHUll5V2NvNUZBMndMTXozU1hkaEZtTWE1V0orRi9yenN1YnUyL3Y5VUdETThGbU95cUJXODlLYlN6Y2lvRnBDVkRhMVB2OW5RcE5BZjF2NkEzejN0OHlzN1pLRmR5MTc1OFlxM0hXVmYyVHNyOWFQRW5ybFBoTzdjV05LUVNTMENBRXViRGoyWTF5ci9kZ0drUUJZempxVFd5b2hMdEV3RkphWDNBTVU4U0w4U3FDOE9Xdi9HdVBXbEJzMEdwTE9YeVZ3Rnc3cnR6RWF5dVVMVTRBWHkxYjJwd3JYVnRVUUY0VHZyOVNHQzRmMTQ5UWZzbjh3S21BVmM1d3B5T1Mxa1VnMDhDQU1FNkgzQ1JxR1BPOTBXcVVjZzFrMjY5SndVM05UMVpFSVlTZGxKakJtTVFVMHRheDR3Zz09PC9kczpTaWduYXR1cmVWYWx1ZT48ZHM6S2V5SW5mbz48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlEaERDQ0FteWdBd0lCQWdJR0FXYXN0N3d2TUEwR0NTcUdTSWIzRFFFQkN3VUFNSUdDTVFzd0NRWURWUVFHRXdKVlV6RUxNQWtHQTFVRUNCTUNSa3d4RXpBUkJnTlZCQWNUQ2tObGJHSnlZWFJwYjI0eElEQWVCZ05WQkFvVEYxUm9aU0JYWVd4MElFUnBjMjVsZVNCRGIyMXdZVzU1TVEwd0N3WURWUVFMRXdSSlpFRk5NU0F3SGdZRFZRUURFeGR6YzNKellUQXhMbTE1YVdRdVpHbHpibVY1TG1OdmJUQWVGdzB4T0RFd01qVXhPVE16TXpSYUZ3MHlPREV3TWpJeE9UTXpNelJhTUlHQ01Rc3dDUVlEVlFRR0V3SlZVekVMTUFrR0ExVUVDQk1DUmt3eEV6QVJCZ05WQkFjVENrTmxiR0p5WVhScGIyNHhJREFlQmdOVkJBb1RGMVJvWlNCWFlXeDBJRVJwYzI1bGVTQkRiMjF3WVc1NU1RMHdDd1lEVlFRTEV3UkpaRUZOTVNBd0hnWURWUVFERXhkemMzSnpZVEF4TG0xNWFXUXVaR2x6Ym1WNUxtTnZiVENDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFKQWVOVDJYczkxcTc3ay80Y3EzdzhldmIwcGdzUk45UTdwam1wYUU2VWFiS0o2T1FMN2wvVlkwa3JhL3ZmdWVjbFRJM1JMTWN5d0RGME9vWGZRcG9xNHZxbVdYNFVERmdKb2lKSmVJSXZ3NVo1dHVoNzNpaFczNFNscDhibHJUeGV4L3BLOStrbm9YRWNRTkdtakFDNFVaanpJYmxISlNIVzFXYTFielM3UmdiN2NhRGM0Q1BwUGZkcU0vdHVKWVp3RFdJSzdtUEtQKy9TbkU4N0NmR0M2a3gxcUMwaEpjcitOOUpCMWZWVXN0VFZiQ1hvdWE2RnJJVnBTSWhoTmRQTERGSUFkdmNTdDExdzVwOVZWdHdMYWpsM21COTU4NSs2WkZoRkhITENkSjRIOU96VkJnOUs5cmZmZFhTeHo1SGtwb2d1ZGgvaXdveWJkK3RMOWZPMkVDQXdFQUFUQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFlT0VXYWxZTHZJRVpob1g3cXhPYThzcE0yZTJLZ0JIdjkvRGRFa0ZwRTlwanpJNVhzOWZ4WUdJQmkvb25NenN3RWhUQU53azRNclM2ZFk0MGhzL3N4UldsU3Rub1Z4eTcwaVR5cnpvSDJyQURrT2s2UzVtUU5EMk1hRGVxL0NFUGZOSTA3MW1yTE5SNnNQUU0yazY5akd6YnJkUy8wSzNJSGo0blNlSUxqeGRMMmlBMHphQUpsaC9WQjd3Yi94WFpaMCt1c3dmSFFuYkdoNVNtcjlWSTlLaW00aUZoTjM4VGJpOGxsbXlPeENrYUVveHZwVEtwRnFEbEtBSThiaFhtR1g1ZlZOcGViaXNTa24zYkhaZG40dFRRVUtTYkRLbHVRR2hQMU5xQ3U4N25ockhOZ1NmYWhtNXZ2TjlKRTF2cERPOEYrTUQ0U3ErUlZrRmwrYyt1dUE9PTwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE+PC9kczpLZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjxzYW1scDpTdGF0dXM+PHNhbWxwOlN0YXR1c0NvZGUgVmFsdWU9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2VzcyIvPjwvc2FtbHA6U3RhdHVzPjxzYW1sOkFzc2VydGlvbiBJRD0ibFpMTTRkVGZrcktGNlRIMloxdERtLkg0RThuIiBJc3N1ZUluc3RhbnQ9IjIwMjMtMDEtMjdUMDQ6MjY6MzQuMjQwWiIgVmVyc2lvbj0iMi4wIiB4bWxuczpzYW1sPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj48c2FtbDpJc3N1ZXI+aHR0cHM6Ly9pZHAubXlpZC5kaXNuZXkuY29tPC9zYW1sOklzc3Vlcj48c2FtbDpTdWJqZWN0PjxzYW1sOk5hbWVJRCBGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjEuMTpuYW1laWQtZm9ybWF0OnVuc3BlY2lmaWVkIj4wYjg2YTM2ZS0xMmExLTQzZDQtYjU0Mi0wODM0NWVlOGZkYTA8L3NhbWw6TmFtZUlEPjxzYW1sOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48c2FtbDpTdWJqZWN0Q29uZmlybWF0aW9uRGF0YSBSZWNpcGllbnQ9Imh0dHA6Ly9sb2NhbGhvc3Q6ODAwMC9hcGkvc2FtbCIgTm90T25PckFmdGVyPSIyMDIzLTAxLTI3VDA0OjMxOjM0LjI0MVoiLz48L3NhbWw6U3ViamVjdENvbmZpcm1hdGlvbj48L3NhbWw6U3ViamVjdD48c2FtbDpDb25kaXRpb25zIE5vdEJlZm9yZT0iMjAyMy0wMS0yN1QwNDoyMTozNC4yNDFaIiBOb3RPbk9yQWZ0ZXI9IjIwMjMtMDEtMjdUMDQ6MzE6MzQuMjQxWiI+PHNhbWw6QXVkaWVuY2VSZXN0cmljdGlvbj48c2FtbDpBdWRpZW5jZT5zaGRyLXJtLWRldmVsb3BtZW50PC9zYW1sOkF1ZGllbmNlPjwvc2FtbDpBdWRpZW5jZVJlc3RyaWN0aW9uPjwvc2FtbDpDb25kaXRpb25zPjxzYW1sOkF1dGhuU3RhdGVtZW50IFNlc3Npb25JbmRleD0ibFpMTTRkVGZrcktGNlRIMloxdERtLkg0RThuIiBBdXRobkluc3RhbnQ9IjIwMjMtMDEtMjdUMDQ6MjY6MzQuMTQzWiI+PHNhbWw6QXV0aG5Db250ZXh0PjxzYW1sOkF1dGhuQ29udGV4dENsYXNzUmVmPnVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphYzpjbGFzc2VzOnVuc3BlY2lmaWVkPC9zYW1sOkF1dGhuQ29udGV4dENsYXNzUmVmPjwvc2FtbDpBdXRobkNvbnRleHQ+PC9zYW1sOkF1dGhuU3RhdGVtZW50PjxzYW1sOkF0dHJpYnV0ZVN0YXRlbWVudD48c2FtbDpBdHRyaWJ1dGUgTmFtZT0iZmlyc3RuYW1lIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj48c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4c2k6dHlwZT0ieHM6c3RyaW5nIiB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiPkFsZXg8L3NhbWw6QXR0cmlidXRlVmFsdWU+PC9zYW1sOkF0dHJpYnV0ZT48c2FtbDpBdHRyaWJ1dGUgTmFtZT0ibWFpbCIgTmFtZUZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmF0dHJuYW1lLWZvcm1hdDp1bnNwZWNpZmllZCI+PHNhbWw6QXR0cmlidXRlVmFsdWUgeHNpOnR5cGU9InhzOnN0cmluZyIgeG1sbnM6eHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIj5hbGV4LnkuaGUuLW5kQGRpc25leS5jb208L3NhbWw6QXR0cmlidXRlVmFsdWU+PC9zYW1sOkF0dHJpYnV0ZT48c2FtbDpBdHRyaWJ1dGUgTmFtZT0ic2FwdWlkIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj48c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4c2k6dHlwZT0ieHM6c3RyaW5nIiB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiPkFsZXguWS5IZS4tTkRAZGlzbmV5LmNvbTwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT48L3NhbWw6QXR0cmlidXRlPjxzYW1sOkF0dHJpYnV0ZSBOYW1lPSJwcmVmZXJyZWRfdXNlcm5hbWUiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6dW5zcGVjaWZpZWQiPjxzYW1sOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciIHhtbG5zOnhzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYSIgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSI+SEVYMDg3PC9zYW1sOkF0dHJpYnV0ZVZhbHVlPjwvc2FtbDpBdHRyaWJ1dGU+PHNhbWw6QXR0cmlidXRlIE5hbWU9Imxhc3RfbmFtZV9maXJzdF9uYW1lIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj48c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4c2k6dHlwZT0ieHM6c3RyaW5nIiB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiPkhlLCBBbGV4IFkuIC1ORDwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT48L3NhbWw6QXR0cmlidXRlPjxzYW1sOkF0dHJpYnV0ZSBOYW1lPSJ1dWlkIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj48c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4c2k6dHlwZT0ieHM6c3RyaW5nIiB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiPjBiODZhMzZlLTEyYTEtNDNkNC1iNTQyLTA4MzQ1ZWU4ZmRhMDwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT48L3NhbWw6QXR0cmlidXRlPjxzYW1sOkF0dHJpYnV0ZSBOYW1lPSJsYXN0bmFtZSIgTmFtZUZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmF0dHJuYW1lLWZvcm1hdDpiYXNpYyI+PHNhbWw6QXR0cmlidXRlVmFsdWUgeHNpOnR5cGU9InhzOnN0cmluZyIgeG1sbnM6eHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIj5IZTwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT48L3NhbWw6QXR0cmlidXRlPjxzYW1sOkF0dHJpYnV0ZSBOYW1lPSJlbXBsb3lfbnVtYmVyIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj48c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4c2k6dHlwZT0ieHM6c3RyaW5nIiB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiPjAxNDc5NzE3PC9zYW1sOkF0dHJpYnV0ZVZhbHVlPjwvc2FtbDpBdHRyaWJ1dGU+PHNhbWw6QXR0cmlidXRlIE5hbWU9InNhcHVpZF91aWQiIE5hbWVGb3JtYXQ9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphdHRybmFtZS1mb3JtYXQ6YmFzaWMiPjxzYW1sOkF0dHJpYnV0ZVZhbHVlIHhzaTp0eXBlPSJ4czpzdHJpbmciIHhtbG5zOnhzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYSIgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSI+SEVYMDg3PC9zYW1sOkF0dHJpYnV0ZVZhbHVlPjwvc2FtbDpBdHRyaWJ1dGU+PHNhbWw6QXR0cmlidXRlIE5hbWU9ImVtYWlsIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj48c2FtbDpBdHRyaWJ1dGVWYWx1ZSB4c2k6dHlwZT0ieHM6c3RyaW5nIiB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiPkFsZXguWS5IZS4tTkRAZGlzbmV5LmNvbTwvc2FtbDpBdHRyaWJ1dGVWYWx1ZT48L3NhbWw6QXR0cmlidXRlPjwvc2FtbDpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PC9zYW1sOkFzc2VydGlvbj48L3NhbWxwOlJlc3BvbnNlPg==`
//   console.log(b64_str)
//   const decode_str = decode(b64_str)
//   console.log(decode_str)
//   ctx.response.body = decode_str;
});

router.put('/', (ctx) => {
  ctx.response.body = 'Received a PUT HTTP method';
});

router.delete('/', (ctx) => {
  ctx.response.body = 'Received a DELETE HTTP method';
});

app.use(router.allowedMethods());
app.use(router.routes());

app.addEventListener('listen', () => {
  console.log(`Listening on: localhost:${port}`);
});

await app.listen({ port });